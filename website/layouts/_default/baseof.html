<!DOCTYPE html>
<html lang='{{ .Site.LanguageCode }}' class="dark" id="htmlElement">

<head>
    <base href="{{ .Site.BaseURL }}" />
    {{- partial "head.html" . -}}
    {{ block "meta_tags" . }}{{end}}
    <style>
        .theme-toggle {
            position: fixed;
            right: 20px;
            bottom: 20px;
            cursor: pointer;
            z-index: 99999;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
        }

        .theme-toggle.dark {
            background: rgba(0, 0, 0, 0.8);
            color: white;
        }
    </style>
</head>

{{ if (or .IsPage .IsHome) }}

<body class="bg-gray-100 flex flex-col min-h-screen dark:bg-black">
    {{ else }}

    <body class="flex flex-col min-h-screen dark:bg-warmgray-800">
        {{end}}
        {{- partial "header.html" . -}}
        <div style="background: url('/img/tiles-transparent.png') repeat;">
            <div class="container mx-auto max-w-10xl px-4 px-0-md my-5 flex-grow" id="content">
                {{- block "main" . }}{{- end }}
            </div>
        </div>

        <!-- 模式切换按钮 - 夜间显示太阳，白天显示月亮 -->
        <div class="theme-toggle" id="themeToggle" title="切换主题模式">
            <svg id="themeIcon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <!-- 默认显示月亮图标(夜间模式默认) -->
                <path id="themePath" d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" />
            </svg>
        </div>

        {{- partial "footer.html" . -}}

        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const themeToggle = document.getElementById('themeToggle');
                const htmlElement = document.getElementById('htmlElement');
                const themePath = document.getElementById('themePath');

                // 检查本地存储中的主题设置
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'light') {
                    // 白天模式：显示月亮图标
                    themePath.setAttribute('d', 'M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z');
                    htmlElement.classList.remove('dark');
                    themeToggle.classList.remove('dark');
                } else {
                    // 夜间模式：显示太阳图标
                    themePath.setAttribute('d', 'M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z');
                }

                // 切换主题
                themeToggle.addEventListener('click', function () {
                    const isDark = htmlElement.classList.contains('dark');

                    if (isDark) {
                        // 当前是夜间模式，切换到白天：显示月亮
                        htmlElement.classList.remove('dark');
                        themeToggle.classList.remove('dark');
                        themePath.setAttribute('d', 'M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z');
                        localStorage.setItem('theme', 'light');
                    } else {
                        // 当前是白天模式，切换到夜间：显示太阳
                        htmlElement.classList.add('dark');
                        themeToggle.classList.add('dark');
                        themePath.setAttribute('d', 'M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z');
                        localStorage.setItem('theme', 'dark');
                    }
                });
            });
        </script>
    </body>

</html>